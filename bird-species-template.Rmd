---
title: "Activity: Bird Species"
author: "Deekshith Reddy Bhoomireddy"
date: "24 July, 2024"
output: html_notebook
---


# Set Up

```{r}
# Load `tidyverse` and `dcData` packages

library(tidyverse)
library(dcData)


# Load the `OrdwayBirds` data set into your RStudio environment from the `dcData` package

data("OrdwayBirds", package = "dcData")


# Show a few commands used to inspect the data set a few different ways
summary("OrdwayBird") #Gives a summary of the dataset.
View(OrdwayBirds) #Opens the dataset.
head(OrdwayBirds, n = 5) #Displays the first 5 rows of the dataset.
tail(OrdwayBirds, n = 5) #Displays the last 5 rows of the dataset.


```

# Activity

When you're finished with this activity, you will have a graph that shows what time of year various species appear at the Katherine Ordway Natural History Study Area in Inver Grove Heights, MN.

### Step 0

Before we begin, the book gives us some instructions to select a few key variables and clean up the date formatting.  Use the commands given in the book, but be sure to study the functions used so you know what is happening.  In this case, we select `SpeciesName`, `Month`, and `Day`. Then a `mutate()` command converts each variable to character, and then converts the resulting "character string" to a number.

```{r}
# Get the data table & clean up dates (see Data Computing eBook)
OrdwayBirds <-
  OrdwayBirds %>%
  select(SpeciesName, Month, Day ) %>%
  mutate(Month = as.numeric(as.character(Month)), #Creates a new column with Month as a numeric character.
          Day = as.numeric(as.character(Day))) #Creates a new column with Day as a numeric character.


# Inspect resulting data
View(OrdwayBirds) #Opens the dataset.
summary("OrdwayBird") #Gives a summary of the dataset.

```



### Step 1




```{r}
# unique species in original data (including mis-spellings)
OrdwayBirds %>%
  n_distinct("SpeciesName")


# unique species in the clean list
data("OrdwaySpeciesNames", package = "dcData")
OrdwaySpeciesNames %>%
  n_distinct("SpeciesNameCleaned")

```


### Step 2
  



```{r}
# inspect OrdwaySpeciesNames
View(OrdwaySpeciesNames)
summary(OrdwaySpeciesNames)

# inner join
Corrected <-
  OrdwayBirds %>%
  full_join(OrdwaySpeciesNames) %>% 
  select( Species = SpeciesNameCleaned, Month, Day ) %>%
  na.omit()  # cleaned up the missing ones



# inspect the data after the join
View(Corrected)
summary(Corrected)

```


### Step 3

We want to identify the top 5-6 bird species sighted at the Katherine Ordway Natural History Study Area.

```{r}
# count sightings by species in descending order

species_desc <-
  OrdwayBirds %>%
  group_by(SpeciesName) %>%
  summarise(count = n()) %>%
  arrange(desc(count))


# a hint in the text book recommends displaying the top 10 species to choose our threshold
head(species_desc, n = 10)


# define a sightings threshold; produce a table with only birds belonging to major species

sightings_threshold <- 600
Majors <- 
  species_desc %>%
  filter(count >= sightings_threshold)

View(Majors)


```


### Step 4

We now want to produce a month-by-month count for each of the major species, and then construct a chart to tell the story of what time of year the various species appear.

```{r}
# prepare glyph-ready data table called `ByMonth`
ByMonth <- 
  Corrected %>%
  filter(Species %in% Majors$SpeciesName) %>%
  count(Species, Month)

View(ByMonth)


```

Now use the ggplot template below to generate the desired graph. (Remark you can also use esquisser or mplot to create a line chart instead of the barchart)



```{r}
#Orders the Months in correct order.
ByMonth$Month <- factor(ByMonth$Month, levels = 1:12)

# ggplot commands

ggplot(ByMonth, aes(x = Month, y = n, group = Species)) +
  geom_line() +
  geom_point() +
  facet_wrap(~ Species) +
  labs(title = "Monthly Sighting Of Major Bird Species",
       x = "Months",
       y = "Number Of Sightings")

```

According to the graph, we can answer the questions posed:

##### 1. Which species are present year-round?  
# American Goldfinch and Black-capped Chickadee are present year-round.


##### 2. Which species are migratory, that is, primarily present in one or two seasons?
# None of these species are migratory


##### 3. What is the peak month for each major species? (bullet list)
# Peack month for each of the species:
# American Goldfinch: 10			
# Black-capped Chickadee: 11			
# Robin: 5			
# Slate-colored Junco: 10


##### 4. Which major species are seen in good numbers for at least 6 months of the year?
# All the species(American Goldfinch, Black-capped Chickadee, Robin, Slate-colored Junco) are seen in good numbers for at least 6 months of the year.


```{r}
#Rough work (code to re-check above questions)
#
# Q1)
# ByMonth %>%
#   group_by(Species) %>%
#   summarise(mont = n_distinct(Month))
# 
# Q2)
# ByMonth %>%
#   group_by(Species) %>%
#   summarise(seas = n_distinct(Month)) %>%
#   filter(seas < 6)
# 
# Q3)
# ByMonth %>%
#   group_by(Species) %>%
#   summarise(months_present = n_distinct(Month)) %>%
#   filter(months_present >= 6)

```

